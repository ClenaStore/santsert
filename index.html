<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Vis√£o Contabilidade Empresarial</title>
<meta name="description" content="Consultoria cont√°bil estrat√©gica, emiss√£o de notas fiscais, certificado digital, marcas & patentes e biblioteca de documentos modelo."/>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
<style>
  :root{
    --wine:#7f1635; --wine-2:#a02146; --gold:#c89b2b;
    --bg:#f8fafc; --text:#0f172a; --muted:#64748b;
    --card:#fff; --line:#e5e7eb; --shadow:0 16px 40px rgba(2,6,23,.08);
    --ok:#16a34a; --warn:#f59e0b;
  }
  *{box-sizing:border-box}
  html,body{margin:0}
  body{font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);color:var(--text)}
  a{color:inherit;text-decoration:none}

  /* HEADER */
  .header{position:sticky;top:0;z-index:60;background:linear-gradient(180deg,var(--wine),var(--wine-2));color:#fff;box-shadow:var(--shadow)}
  .bar{max-width:1200px;margin:auto;padding:12px 18px;display:flex;align-items:center;gap:14px;justify-content:space-between}
  .brand{display:flex;gap:10px;align-items:center;font-weight:800}
  .brand img{width:42px;height:42px;border-radius:10px;background:#fff;border:2px solid rgba(255,255,255,.9);object-fit:cover}
  .nav{display:flex;gap:10px;flex-wrap:wrap}
  .nav a{color:#fff;padding:8px 10px;border-radius:10px}
  .nav a:hover{background:rgba(255,255,255,.18)}
  .btn{appearance:none;border:none;border-radius:12px;padding:10px 14px;font-weight:700;cursor:pointer;position:relative;overflow:hidden;transform:translateZ(0)}
  .btn-brand{background:linear-gradient(180deg,#ffd877,var(--gold));color:#5a3b00;border:1px solid rgba(0,0,0,.08);box-shadow:0 3px 0 #a37714}
  .btn-ghost{background:rgba(255,255,255,.15);color:#fff;border:1px solid rgba(255,255,255,.35)}

  /* Ripple / Press */
  .ripple{position:absolute;border-radius:50%;transform:scale(0);animation:ripple .6s linear;opacity:.35;background:#fff}
  @keyframes ripple{to{transform:scale(4);opacity:0}}
  .press:active{transform:scale(.98)}

  /* === TOP BANNER (abaixo do header) === */
  .top-banner{background:linear-gradient(90deg,rgba(127,22,53,.95),rgba(160,33,70,.95));color:#fff;border-bottom:1px solid rgba(255,255,255,.2)}
  .top-banner .inner{max-width:1200px;margin:auto;display:grid;grid-template-columns:1fr auto;gap:12px;align-items:center;padding:10px 18px}
  .top-banner .msg{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
  .top-banner img{height:44px;width:auto;border-radius:10px;border:2px solid rgba(255,255,255,.6);object-fit:cover}
  .top-banner .cta{background:linear-gradient(180deg,#ffd877,var(--gold));color:#5a3b00;border:none;border-radius:10px;padding:8px 12px;font-weight:800;cursor:pointer}
  .top-banner .close{background:transparent;border:1px solid rgba(255,255,255,.5);color:#fff;border-radius:10px;padding:6px 10px;cursor:pointer}
  @media(max-width:700px){.top-banner .inner{grid-template-columns:1fr}}

  /* HERO */
  .hero{background:
    linear-gradient(180deg,rgba(127,22,53,.85),rgba(160,33,70,.85)),
    url('https://images.unsplash.com/photo-1554224154-22dec7ec8818?q=80&w=1600&auto=format&fit=crop') center/cover no-repeat; color:#fff}
  .hero .inner{max-width:1200px;margin:auto;display:grid;grid-template-columns:1.2fr 1fr;gap:22px;padding:38px 18px}
  @media(max-width:980px){.hero .inner{grid-template-columns:1fr}}
  .headline{font-size:clamp(28px,5vw,48px);margin:0 0 10px}
  .chips{display:flex;flex-wrap:wrap;gap:10px;margin:12px 0}
  .chip{background:rgba(255,255,255,.92);color:#111;border:1px solid rgba(0,0,0,.06);border-radius:999px;padding:6px 10px}
  .hero-card{background:#fff;color:#111;border-radius:16px;padding:16px;border:1px solid var(--line);box-shadow:var(--shadow)}
  .price{font-size:28px;font-weight:800;color:var(--wine);margin:8px 0}

  /* SE√á√ïES GEN√âRICAS */
  .section{max-width:1200px;margin:auto;padding:34px 18px}
  .title{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
  .subtitle{color:var(--muted)}
  .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:16px}
  .card{grid-column:span 6;background:#fff;border:1px solid var(--line);border-radius:16px;padding:16px;box-shadow:var(--shadow)}
  @media(max-width:900px){.card{grid-column:span 12}}
  .card h3{margin:6px 0 8px;color:var(--wine)}

  /* CATEGORIAS (p√≠lulas) */
  .cats{display:flex;gap:8px;flex-wrap:wrap}
  .cat{padding:8px 12px;border-radius:999px;border:1px solid var(--line);background:#fff;cursor:pointer}
  .cat.active{background:var(--wine);border-color:transparent;color:#fff}

  /* DOCUMENTOS (com banner lateral e scroll p/ 6 cards) */
  .docs-wrap{display:grid;grid-template-columns:280px 1fr 260px;gap:16px}
  @media(max-width:1200px){.docs-wrap{grid-template-columns:260px 1fr 240px}}
  @media(max-width:980px){.docs-wrap{grid-template-columns:1fr}} /* empilha no mobile */

  .docs-side{background:#fff;border:1px solid var(--line);border-radius:16px;padding:14px;box-shadow:var(--shadow);height:fit-content;position:sticky;top:86px}
  .search{display:flex;gap:8px;margin-bottom:10px}
  .input{width:100%;padding:12px;border:1px solid var(--line);border-radius:12px}

  /* 6 cards vis√≠veis + scroll */
  .docs-holder{--row: 168px; max-height: calc(var(--row)*2 + 14px); overflow-y:auto; padding-right:6px}
  @media(max-width:980px){.docs-holder{max-height: calc(var(--row)*3 + 28px);}} /* no mobile: 2 col x 3 linhas = 6 */
  .docs{display:grid;grid-template-columns:repeat(3, minmax(240px,1fr));gap:14px}
  @media(max-width:1200px){.docs{grid-template-columns:repeat(3, minmax(220px,1fr));}}
  @media(max-width:980px){.docs{grid-template-columns:repeat(2, minmax(200px,1fr));}}
  .doc{background:#fff;border:1px solid var(--line);border-radius:14px;padding:12px;display:flex;flex-direction:column;gap:8px;min-height:var(--row)}
  .doc small{color:var(--muted)}
  .doc .tags{display:flex;gap:6px;flex-wrap:wrap}
  .tag{font-size:12px;border:1px solid var(--line);padding:3px 8px;border-radius:999px;background:#f9fafb}
  .empty{padding:20px;border:1px dashed var(--line);border-radius:14px;text-align:center;color:var(--muted)}
  /* scrollbar leve */
  .docs-holder::-webkit-scrollbar{width:10px}
  .docs-holder::-webkit-scrollbar-thumb{background:#d1d5db;border-radius:12px}
  .docs-holder::-webkit-scrollbar-track{background:#f3f4f6;border-radius:12px}

  /* BANNER LATERAL */
  .side-banner{background:linear-gradient(180deg,var(--wine),var(--wine-2));color:#fff;border-radius:16px;border:1px solid rgba(255,255,255,.25);box-shadow:var(--shadow);padding:16px;position:sticky;top:86px;height:fit-content}
  .side-banner h4{margin:0 0 6px}
  .side-banner p{margin:0 0 10px;color:#ffecf2}
  .side-banner .cta{background:linear-gradient(180deg,#ffd877,var(--gold));color:#5a3b00;border:none;border-radius:12px;padding:10px 12px;font-weight:800;cursor:pointer}

  /* FOOTER */
  .footer{background:#1a1a1a;color:#fff;margin-top:20px}
  .footer .inner{max-width:1200px;margin:auto;padding:28px 18px;display:grid;grid-template-columns:2fr 1fr;gap:20px;align-items:center}
  @media(max-width:900px){.footer .inner{grid-template-columns:1fr}}
</style>
</head>
<body>
  <!-- HEADER -->
  <header class="header">
    <div class="bar">
      <div class="brand">
        <img src="https://dummyimage.com/42x42/ffffff/7f1635.png&text=V" alt="Logo Vis√£o">
        <span>Vis√£o Contabilidade Empresarial</span>
      </div>
      <nav class="nav">
        <a href="#servicos">Servi√ßos</a>
        <a href="#notas">Notas Fiscais</a>
        <a href="#certificado">Certificado</a>
        <a href="#docs">Modelos</a>
        <a href="#formularios">Formul√°rios</a>
        <a href="#contato">Contato</a>
      </nav>
      <button class="btn btn-ghost press" data-ripple onclick="scrollToId('docs')">Baixar modelos</button>
    </div>
  </header>

  <!-- TOP BANNER (abaixo do header) -->
  <section class="top-banner" id="topBanner">
    <div class="inner">
      <div class="msg">
        <img src="https://images.unsplash.com/photo-1556157382-97eda2d62296?q=80&w=800&auto=format&fit=crop" alt="Campanha Certificado Digital">
        <div>
          <strong>Promo ‚Ä¢ Certificado Digital A1/A3</strong><br>
          <small>Libera√ß√£o r√°pida ‚Ä¢ Atendimento por v√≠deo ‚Ä¢ at√© 12x</small>
        </div>
      </div>
      <div style="display:flex;gap:8px;align-items:center">
        <button class="cta press" data-ripple onclick="scrollToId('certificado')">Emitir agora</button>
        <button class="close press" data-ripple onclick="dismissTopBanner()">‚úï</button>
      </div>
    </div>
  </section>

  <!-- HERO -->
  <section class="hero" id="home">
    <div class="inner">
      <div>
        <h1 class="headline">Contabilidade moderna, estrat√©gica e acess√≠vel</h1>
        <p class="subtitle">üìå Consultoria Cont√°bil Estrat√©gica ‚Ä¢ üìä MEI ‚Ä¢ üîê Certificado Digital ‚Ä¢ ¬Æ Marcas & Patentes</p>
        <div class="chips">
          <span class="chip">DRE e dashboards</span>
          <span class="chip">Obriga√ß√µes em dia</span>
          <span class="chip">Atendimento humano</span>
          <span class="chip">LGPD</span>
        </div>
        <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:6px">
          <button class="btn btn-brand press" data-ripple onclick="scrollToId('planos')">Ver planos</button>
          <button class="btn btn-ghost press" data-ripple onclick="scrollToId('formularios')">Solicitar agora</button>
        </div>
      </div>
      <div class="hero-card">
        <strong>Sistema de Emiss√£o de Notas Fiscais</strong>
        <p class="subtitle">Simples, r√°pido e seguro para produtos e servi√ßos. Ideal para pequenos e m√©dios neg√≥cios.</p>
        <div class="price">A partir de R$ 31,99</div>
        <button class="btn btn-brand press" data-ripple onclick="scrollToId('notas')">Quero emitir NF-e</button>
      </div>
    </div>
  </section>

  <!-- SERVI√áOS + CATEGORIAS -->
  <section class="section" id="servicos">
    <div class="title">
      <h2>Servi√ßos</h2>
      <div class="cats" id="cat-servicos">
        <button class="cat active press" data-ripple data-cat="todos">Todos</button>
        <button class="cat press" data-ripple data-cat="societario">Societ√°rio</button>
        <button class="cat press" data-ripple data-cat="fiscal">Fiscal/Tribut√°rio</button>
        <button class="cat press" data-ripple data-cat="dp">Departamento Pessoal</button>
        <button class="cat press" data-ripple data-cat="bpo">BPO Financeiro</button>
        <button class="cat press" data-ripple data-cat="cert">Certificado Digital</button>
        <button class="cat press" data-ripple data-cat="marcas">Marcas & Patentes</button>
      </div>
    </div>
    <div class="grid" id="servicos-grid"></div>
  </section>

  <!-- NOTAS FISCAIS -->
  <section class="section" id="notas">
    <div class="title"><h2>Notas Fiscais sem complica√ß√£o</h2><span class="subtitle">Sistema intuitivo, suporte e integra√ß√£o</span></div>
    <div class="grid">
      <article class="card"><h3>Implanta√ß√£o</h3><p>Configuramos natureza de opera√ß√µes, s√©ries e certificados.</p></article>
      <article class="card"><h3>Treinamento</h3><p>Passo a passo para emiss√£o e cancelamento.</p></article>
      <article class="card"><h3>Suporte</h3><p>Equipe pronta para d√∫vidas e conting√™ncias.</p></article>
      <article class="card"><h3>Relat√≥rios</h3><p>Emiss√£o e exporta√ß√£o de notas, XML e DANFE.</p></article>
    </div>
  </section>

  <!-- CERTIFICADO DIGITAL -->
  <section class="section" id="certificado">
    <div class="title"><h2>SantCert ‚Äì Certifica√ß√£o Digital</h2><span class="subtitle">Atendimento presencial ou por videoconfer√™ncia</span></div>
    <div class="grid">
      <article class="card"><h3>e-CPF (A1/A3)</h3><p>Assine documentos e acesse servi√ßos online com validade jur√≠dica.</p></article>
      <article class="card"><h3>e-CNPJ (A1/A3)</h3><p>Identidade digital da empresa; NF-e, Receita Federal, licita√ß√µes e mais.</p></article>
      <article class="card"><h3>Suporte completo</h3><p>Seguran√ßa, confiabilidade e orienta√ß√£o em todas as etapas.</p></article>
    </div>
  </section>

  <!-- BIBLIOTECA DE DOCUMENTOS (downloads + busca + banner lateral) -->
  <section class="section" id="docs">
    <div class="title"><h2>Modelos para baixar</h2><span class="subtitle">Pesquise por nome ou filtre por categoria</span></div>
    <div class="docs-wrap">
      <!-- LADO ESQUERDO: filtro -->
      <aside class="docs-side">
        <div class="search">
          <input id="q" class="input" placeholder="Pesquise por nome, palavra-chave... (ex: contrato, procura√ß√£o)"/>
          <button class="btn btn-brand press" data-ripple onclick="searchDocs()">Buscar</button>
        </div>
        <strong>Categorias</strong>
        <div class="cats" id="cat-docs" style="margin-top:8px">
          <button class="cat active press" data-ripple data-cat="todas">Todas</button>
          <button class="cat press" data-ripple data-cat="societario">Societ√°rio</button>
          <button class="cat press" data-ripple data-cat="fiscal">Fiscal</button>
          <button class="cat press" data-ripple data-cat="dp">DP</button>
          <button class="cat press" data-ripple data-cat="financeiro">Financeiro</button>
          <button class="cat press" data-ripple data-cat="cert">Certificado</button>
          <button class="cat press" data-ripple data-cat="marcas">Marcas</button>
        </div>
        <p class="subtitle" id="count" style="margin-top:10px">‚Äî</p>
      </aside>

      <!-- CENTRO: grade com SCROLL (6 cards vis√≠veis) -->
      <div class="docs-holder">
        <div class="docs" id="docs-grid"><div class="empty">Nenhum documento encontrado.</div></div>
      </div>

      <!-- DIREITA: banner lateral -->
      <aside class="side-banner">
        <h4>Promo ‚Ä¢ Certificado Digital</h4>
        <p>A1/A3 com libera√ß√£o r√°pida e atendimento por v√≠deo.</p>
        <ul style="margin:0 0 10px 18px">
          <li>Parcelamento em at√© 12x</li>
          <li>Validades 12‚Äì36 meses</li>
          <li>Suporte especializado</li>
        </ul>
        <button class="cta press" data-ripple onclick="scrollToId('certificado')">Emitir agora</button>
      </aside>
    </div>
  </section>

  <!-- FORMUL√ÅRIOS -->
  <section class="section" id="formularios">
    <div class="title"><h2>Solicite agora</h2><span class="subtitle">Chega na planilha e por e-mail do setor</span></div>

    <!-- Societ√°rio -->
    <article class="card">
      <h3>üßæ Societ√°rio (Abertura/Altera√ß√£o/Encerramento)</h3>
      <form class="grid" data-form="societario" onsubmit="submitForm(event)">
        <input class="input" name="nome" placeholder="Nome/Raz√£o Social" required>
        <input class="input" name="cnpj" placeholder="CNPJ" required>
        <input class="input" type="email" name="email" placeholder="E-mail" required>
        <input class="input" name="telefone" placeholder="Telefone (WhatsApp)" required>
        <select class="input" name="tipo" required>
          <option value="">Tipo‚Ä¶</option><option>Abertura</option><option>Altera√ß√£o</option><option>Encerramento</option>
        </select>
        <textarea class="input full" name="mensagem" placeholder="Detalhes"></textarea>
        <div class="full" style="display:flex;gap:10px;justify-content:flex-end">
          <button class="btn press" data-ripple type="reset">Limpar</button>
          <button class="btn btn-brand press" data-ripple type="submit">Enviar</button>
        </div>
      </form>
    </article>

    <!-- Certificado Digital -->
    <article class="card">
      <h3>üîê Certificado Digital</h3>
      <form class="grid" data-form="certificado" onsubmit="submitForm(event)">
        <select class="input" name="tipo" required><option value="">Tipo‚Ä¶</option><option value="A1">A1</option><option value="A3">A3</option></select>
        <select class="input" name="pessoa" required><option value="">Pessoa‚Ä¶</option><option>PF</option><option>PJ</option></select>
        <input class="input" name="nome" placeholder="Nome/Raz√£o Social" required>
        <input class="input" name="cnpj" placeholder="CPF/CNPJ" required>
        <input class="input" type="email" name="email" placeholder="E-mail" required>
        <input class="input" name="telefone" placeholder="Telefone (WhatsApp)" required>
        <textarea class="input full" name="mensagem" placeholder="Observa√ß√µes"></textarea>
        <div class="full" style="display:flex;gap:10px;justify-content:flex-end">
          <button class="btn press" data-ripple type="reset">Limpar</button>
          <button class="btn btn-brand press" data-ripple type="submit">Solicitar</button>
        </div>
      </form>
    </article>
  </section>

  <!-- PLANOS -->
  <section class="section" id="planos">
    <div class="title"><h2>Planos</h2><span class="subtitle">Personalizamos conforme sua realidade</span></div>
    <div class="grid">
      <article class="card"><h3>Essencial</h3><div class="price">R$ 349/m√™s</div><p>Fiscal + DP at√© 3 colaboradores ‚Ä¢ DRE simplificada</p></article>
      <article class="card" style="border:2px solid var(--wine)"><h3>Profissional</h3><div class="price">R$ 699/m√™s</div><p>Fiscal + DP at√© 10 ‚Ä¢ Fluxo de caixa e DRE ‚Ä¢ Suporte priorizado</p></article>
      <article class="card"><h3>Corporativo</h3><div class="price">Sob consulta</div><p>Filiais, BPO completo e relat√≥rios avan√ßados</p></article>
    </div>
  </section>

  <!-- FOOTER -->
  <footer class="footer" id="contato">
    <div class="inner">
      <div>
        <h3>Fale com a Vis√£o</h3>
        <p class="subtitle">(00) 00000-0000 ‚Ä¢ atendimento@visaocontabil.com.br</p>
        <p class="subtitle">Av. Exemplo, 123 ‚Äì Centro ‚Äì Sua Cidade/UF</p>
        <p class="subtitle">¬© <span id="year"></span> Vis√£o Contabilidade</p>
      </div>
      <div style="display:flex;gap:10px;justify-content:flex-end">
        <button class="btn btn-brand press" data-ripple onclick="scrollToId('formularios')">Solicitar agora</button>
      </div>
    </div>
  </footer>

<script>
  // ====== CONFIG ======
  const GAS_ENDPOINT = "https://script.google.com/macros/s/SEU_ID_DO_WEBAPP/exec"; // substitua pela sua URL

  // ====== Ripple (microintera√ß√£o) ======
  document.addEventListener('click', e=>{
    const btn = e.target.closest('[data-ripple]');
    if(!btn) return;
    const r=document.createElement('span');
    const d=Math.max(btn.clientWidth, btn.clientHeight);
    const rect=btn.getBoundingClientRect();
    r.className='ripple';
    r.style.width=r.style.height=d+'px';
    r.style.left=(e.clientX-rect.left-d/2)+'px';
    r.style.top=(e.clientY-rect.top-d/2)+'px';
    btn.appendChild(r);
    setTimeout(()=>r.remove(),600);
  });

  // ====== Util ======
  function scrollToId(id){ document.getElementById(id)?.scrollIntoView({behavior:'smooth'}); }
  document.getElementById('year').textContent=new Date().getFullYear();

  // ====== TOP BANNER: fechar e lembrar por 1 dia ======
  const TOP_BANNER_KEY='visao.top.banner.hide';
  function dismissTopBanner(){
    const oneDay=24*60*60*1000;
    localStorage.setItem(TOP_BANNER_KEY, String(Date.now()+oneDay));
    document.getElementById('topBanner')?.remove();
  }
  (function restoreTopBanner(){
    const until=Number(localStorage.getItem(TOP_BANNER_KEY)||0);
    if(until && Date.now()<until){
      document.getElementById('topBanner')?.remove();
    }
  })();

  // ====== Servi√ßos (com categorias) ======
  const SERVICOS = [
    {t:'Contabilidade Gerencial', d:'Indicadores, DRE e fluxo de caixa.', c:'bpo'},
    {t:'Fiscal & Tribut√°rio', d:'Planejamento, apura√ß√£o e revis√£o.', c:'fiscal'},
    {t:'Departamento Pessoal', d:'Folha, admiss√µes, rescis√µes e benef√≠cios.', c:'dp'},
    {t:'Regulariza√ß√µes', d:'Abertura/altera√ß√£o/baixa e certid√µes.', c:'societario'},
    {t:'Certificado Digital', d:'Emiss√£o A1/A3 ‚Äì presencial ou v√≠deo.', c:'cert'},
    {t:'Marcas & Patentes', d:'Pesquisa, registro e acompanhamento.', c:'marcas'},
  ];
  const gridServ=document.getElementById('servicos-grid');
  const catServ=document.getElementById('cat-servicos');
  function renderServ(cat='todos'){
    gridServ.innerHTML='';
    SERVICOS.filter(s=>cat==='todos'||s.c===cat).forEach(s=>{
      const el=document.createElement('article');
      el.className='card press';
      el.setAttribute('data-ripple','');
      el.innerHTML=`<h3>${s.t}</h3><p class="subtitle">${s.d}</p>`;
      gridServ.appendChild(el);
    });
  }
  renderServ();
  catServ?.addEventListener('click',e=>{
    const b=e.target.closest('.cat'); if(!b) return;
    catServ.querySelectorAll('.cat').forEach(x=>x.classList.remove('active'));
    b.classList.add('active'); renderServ(b.dataset.cat);
  });

  // ====== Biblioteca de Documentos (busca + categorias + scroll 6) ======
  const DOCS = [
    {id:1, nome:'Checklist de Abertura (PF/PJ)', cat:'societario', ext:'PDF', link:'#', tags:['abertura','empresa','documentos']},
    {id:2, nome:'Modelo de Contrato Social', cat:'societario', ext:'DOCX', link:'#', tags:['contrato','societario']},
    {id:3, nome:'Procura√ß√£o (Fiscal/Banc√°ria)', cat:'fiscal', ext:'DOCX', link:'#', tags:['procura√ß√£o','fisco']},
    {id:4, nome:'Termo de Responsabilidade DP', cat:'dp', ext:'DOCX', link:'#', tags:['dp','pessoal']},
    {id:5, nome:'Planilha ‚Äì Contas a Pagar/Receber', cat:'financeiro', ext:'XLSX', link:'#', tags:['bpo','financeiro']},
    {id:6, nome:'Requerimento de Marca (INPI)', cat:'marcas', ext:'PDF', link:'#', tags:['marcas','inpi']},
    {id:7, nome:'Checklist Emiss√£o NF-e', cat:'fiscal', ext:'PDF', link:'#', tags:['nfe','notas']},
    {id:8, nome:'Formul√°rio de Valida√ß√£o ‚Äì e-CPF/e-CNPJ', cat:'cert', ext:'PDF', link:'#', tags:['certificado','icp-brasil']},
    {id:9, nome:'Procura√ß√£o p/ Receita Federal', cat:'fiscal', ext:'PDF', link:'#', tags:['procura√ß√£o','rf']},
    {id:10, nome:'Planilha Fluxo de Caixa', cat:'financeiro', ext:'XLSX', link:'#', tags:['fluxo','caixa']},
    {id:11, nome:'Aditivo Contratual', cat:'societario', ext:'DOCX', link:'#', tags:['aditivo','contrato']},
    {id:12, nome:'Ficha de Registro ‚Äì DP', cat:'dp', ext:'DOCX', link:'#', tags:['registro','dp']},
  ];
  let DOC_CAT='todas', DOC_Q='';
  const docsGrid=document.getElementById('docs-grid');
  const catDocs=document.getElementById('cat-docs');
  const q=document.getElementById('q');
  const count=document.getElementById('count');

  function labelCat(c){
    return {societario:'Societ√°rio', fiscal:'Fiscal', dp:'DP', financeiro:'Financeiro', cert:'Certificado', marcas:'Marcas'}[c]||'Outros';
  }
  function renderDocs(){
    const qn = DOC_Q.trim().toLowerCase();
    const list = DOCS.filter(d=>{
      const inCat = (DOC_CAT==='todas' || d.cat===DOC_CAT);
      const str = (d.nome+' '+d.tags.join(' ')).toLowerCase();
      const inQ = !qn || str.includes(qn);
      return inCat && inQ;
    });
    count.textContent = `${list.length} documento(s)`;
    docsGrid.innerHTML = list.length ? '' : `<div class="empty">Nenhum documento encontrado.</div>`;
    list.forEach(d=>{
      const el=document.createElement('article');
      el.className='doc press'; el.setAttribute('data-ripple','');
      el.innerHTML = `
        <div><strong>${d.nome}</strong><small>${labelCat(d.cat)} ‚Ä¢ ${d.ext}</small></div>
        <div class="tags">${d.tags.map(t=>`<span class="tag">${t}</span>`).join('')}</div>
        <div style="margin-top:auto;display:flex;gap:8px">
          <a class="btn btn-brand press" data-ripple href="${d.link}" download>Baixar</a>
          <button class="btn press" data-ripple onclick="copyLink('${d.link}')">Copiar link</button>
        </div>`;
      docsGrid.appendChild(el);
    });
  }
  function searchDocs(){ DOC_Q = q.value; renderDocs(); }
  q?.addEventListener('input', searchDocs);
  catDocs?.addEventListener('click', e=>{
    const b=e.target.closest('.cat'); if(!b) return;
    catDocs.querySelectorAll('.cat').forEach(x=>x.classList.remove('active'));
    b.classList.add('active'); DOC_CAT=b.dataset.cat; renderDocs();
  });
  function copyLink(link){
    const full = link.startsWith('http') ? link : (location.origin+link);
    navigator.clipboard.writeText(full).then(()=>alert('Link copiado!'));
  }
  renderDocs();

  // ====== Envio gen√©rico p/ GAS ======
  async function submitForm(e){
    e.preventDefault();
    const form=e.target.closest('form');
    const fd=new FormData(form);
    fd.append('form', form.dataset.form||'geral');
    try{
      const res=await fetch(GAS_ENDPOINT,{method:'POST',body:fd});
      const data=await res.json().catch(()=>({}));
      if(!res.ok || data.status!=='ok') throw new Error(data.message||'Falha no envio');
      alert('Solicita√ß√£o enviada com sucesso!');
      form.reset();
    }catch(err){
      console.error(err);
      alert('N√£o foi poss√≠vel enviar. Verifique a conex√£o e tente novamente.');
    }
  }
</script>
</body>
</html>
